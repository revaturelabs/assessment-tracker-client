let base_url = "http://34.204.173.118:5000/",
	java_base_url = "http://34.204.173.118:7001/",
	loginData = {},
	batches = {},
	months = [
		"January",
		"February",
		"March",
		"April",
		"May",
		"June",
		"July",
		"August",
		"September",
		"October",
		"November",
		"December",
	],
	mainHeader = `
<nav class="nav top-nav navbar-expand-lg d-flex justify-content-between bg-dark" aria-labelledby="Topbar navigation">
    <a class="navbar-toggler rounded-0" type="button" data-toggle="collapse" data-target="#navbarToggle" aria-controls="navbarToggle" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon text-darker text-center rounded-0">
            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-list" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z"/>
            </svg>
        </span>
    </a>
    <a class="navbar-brand order-xs-1 order-sm-1 order-md-1 order-lg-1 order-md-1 col col-6 col-sm-4 col-md-3 col-lg-2" href="home.html"><img src="images/rev-logo.png" alt="Revature Logo"></a>
    <div class="order-xs-3 order-sm-3 order-md-2 order-lg-3 order-md-3 mr-3 col col-3 col-sm-2">
        <a id="loginBtn" data-toggle="modal" data-target="#loginModal" data-preLoad="Some content to pre-load" class="nav-link d-flex text-dark bg-info align-items-center">Log In &nbsp;<i class="fa fa-sign-in" aria-hidden="true"></i></a>
    </div>
    <div class="collapse navbar-collapse order-xs-3 order-sm-3 order-md-3 order-lg-2 col-xs-12 bg-dark py-3" id="navbarToggle">
        <form class="mr-5 col-md-9 col-sm-12 needs-validation" novalidate autocomplete="off">
            <div class="input-group">
                <div class="input-group-prepend">
                    <label for="search" id="searchLabel" class="input-group-text bg-darkest border-none text-light"><i class="fa fa-search" aria-hidden="true"></i></label>
                </div>
                <input oninput="document.getElementById('searchSuggestion').classList.remove('d-none');searchBatches(this.value);" id="search" class="form-control bg-darkest border-none col col-12 rounded-right" type="search" placeholder="Search" aria-label="Search" aria-describedby="Search a batch" />
                <div class="bg-darkest rounded col col-12 p-3 d-none" id="searchSuggestion"></div>
            </div>
        </form>
    </div>
</nav>`,
	onPage = "text-light",
	offPage = "text-dark",
	mustLogin = `
<div class="col-sm-1-10">
    <div class="card mb-5 bg-darker p-3">
        <div class="card-body rounded p-3">
            <h3 class="card-title"><strong>Please Log In</strong></h3>
            <p class="">If you would like to view your batches then please <a data-toggle="modal" href="#loginModal">Log In Here</a>, or you may click the link above.</p>
        </div>
    </div>
</div>`,
	tempMainContentHolder = $("#mainbody").html();
function ajaxCaller(a, b, c, d, e, f) {
	if (document.getElementById(e)) {
		document.getElementById(e).innerHTML = "";
		let a = document.createElement("div");
		a.setAttribute("class", "loader"),
			document.getElementById(e).appendChild(a);
	}
	let g = new XMLHttpRequest();
	(g.onreadystatechange = function () {
		if (4 == this.readyState) {
			document.getElementById(e).innerHTML = "";
			let a = this.responseText;
			c(this.status, a, d, e);
		}
	}),
		g.open(a, b, !0),
		f
			? (g.setRequestHeader("Content-Type", "application/json"),
			  g.send(JSON.stringify(f)))
			: g.send();
}
function logMeIN(a) {
	let b = a;
	console.log(b),
		ajaxCaller(
			"POST",
			base_url + "trainer/",
			logMeIN_complete,
			"loadResult",
			"logload",
			b
		);
}
function logMeIN_complete(a, b, c) {
	200 == a
		? ($("#loginBtn").html(
				`Log Out &nbsp;<i class="fa fa-sign-out" aria-hidden="true"></i>`
		  ),
		  document
				.getElementById("loginBtn")
				.setAttribute("data-target", "#logoutModal"),
		  saveSession(loginData, b),
		  (loginData = getSession(loginData, !0)),
		  console.log(loginData),
		  $("#loginModal").modal("hide"),
		  pageDataToLoad())
		: 201 == a
		? (document.getElementById(c).innerHTML = JSON.parse(b))
		: 404 == a &&
		  (document.getElementById(
				c
		  ).innerHTML = `<p class="text-danger">${b}!</p>`);
}
function searchBatches(a) {
	let b = `batches/search/${loginData.id}/${a}`,
		c = "searchSuggestion";
	console.log("searchVal"),
		console.log(a),
		a && loginData.id != null
			? ajaxCaller("GET", base_url + b, searchBatches_complete, c, c, "")
			: loginData.id == null &&
			  (document.getElementById(
					"searchSuggestion"
			  ).innerHTML = `<div class="d-block m-1 bg-lighter rounded"><p class="d-block text-center text-black p-3 bg-lighter rounded">Please <a class="text-info login-modal-link rounded" data-toggle="modal" href="#loginModal">Log In</a> to use this search feature.</p></div>`),
		a ||
			document
				.getElementById("searchSuggestion")
				.classList.contains("d-none") ||
			document.getElementById("searchSuggestion").classList.add("d-none");
}
function searchBatches_complete(a, b, c) {
	if (200 == a) {
		let a = JSON.parse(b);
		console.log(a),
			(document.getElementById(c).innerHTML =
				0 >= Object.keys(a).length
					? `<div class="d-block m-1 bg-lighter rounded"><p class="d-block text-center text-black p-3 bg-lighter rounded">- No Batches with this name exist! -</p></div>`
					: styleSearch(a, document.getElementById("search").value));
	} else
		201 == a
			? (document.getElementById(c).innerHTML = JSON.parse(b))
			: 400 == a && (document.getElementById(c).innerHTML = b);
}
(function () {
	"use strict";
	window.addEventListener(
		"load",
		function () {
			$("#headContent").html(mainHeader),
				getSession(loginData, !0)
					? ((loginData = getSession(loginData, !0)),
					  console.log(loginData),
					  pageDataToLoad(),
					  $("#loginBtn").html(
							`Log Out&nbsp;<i class="fa fa-sign-out" aria-hidden="true"></i>`
					  ),
					  document
							.getElementById("loginBtn")
							.setAttribute("data-target", "#logoutModal"))
					: ((tempMainContentHolder = $("#mainbody").html()),
					  $("#mainbody").html(mustLogin)),
				$("#navController").html(setMainNav());
			var a = document.getElementsByClassName("needs-validation");
			Array.prototype.filter.call(a, function (a) {
				a.addEventListener(
					"submit",
					function (b) {
						b.stopPropagation(),
							b.preventDefault(),
							!1 === a.checkValidity()
								? console.log("Form not valid")
								: console.log("Form is valid"),
							a.classList.add("was-validated");
					},
					!1
				);
			});
		},
		!1
	);
})();
function setMainNav() {
	return `
    <a class="nav-link ${onHome} d-flex align-items-center justify-content-center justify-content-md-start" title="Home" href="home.html"><i class="fa fa-home" aria-hidden="true"></i>&nbsp;<span class="d-none d-md-inline">Home</span></a>
    <a class="nav-link ${onBatch} d-flex align-items-center justify-content-center justify-content-md-start" title="Batch" href="batch_home.html"><i class="fa fa-users" aria-hidden="true"></i>&nbsp;<span class="d-none d-md-inline">Batch</span></a>
    <!--<a class="nav-link ${onAssess} d-flex align-items-center justify-content-center justify-content-md-start" title="Assessments" href="assessments.html"><i class="fa fa-pencil-square-o" aria-hidden="true"></i>&nbsp;<span class="d-none d-md-inline">Assessments</span></a>
    <a class="nav-link ${onNotes} d-flex align-items-center justify-content-center justify-content-md-start" title="Notes" href="#">
        <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-journal-text" viewBox="0 0 16 16">
            <path d="M5 10.5a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5zm0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5z"/>
            <path d="M3 0h10a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-1h1v1a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v1H1V2a2 2 0 0 1 2-2z"/>
            <path d="M1 5v-.5a.5.5 0 0 1 1 0V5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0V8h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0v.5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1z"/>
        </svg>
    &nbsp;<span class="d-none d-md-inline">Notes</span>
    </a>-->`;
}
function logout() {
	$("#loginBtn").html(
		`Log In&nbsp;<i class="fa fa-sign-in" aria-hidden="true"></i>`
	),
		document
			.getElementById("loginBtn")
			.setAttribute("data-target", "#loginModal"),
		(tempMainContentHolder = $("#mainbody").html()),
		$("#mainbody").html(mustLogin),
		(loginData = {});
}
function extractObjectFromForm(a, b) {
	var c = [],
		d = $.map(a.find(":input"), function (a) {
			var b = {};
			return (
				$(a).is("input:text") ||
				$(a).is("textarea") ||
				$(a).is("input:hidden") ||
				$(a).is("input:password")
					? (b[a.name] = $(a).val())
					: $(a).is("input:checkbox")
					? (b[a.name] = !!$(a).is(":checked"))
					: "radio" == a.type
					? -1 == c.indexOf(a.name) && c.push(a.name)
					: (b[a.name] = $(a).val()),
				b
			);
		});
	return (
		$.each(c, function (a, b) {
			var c = {};
			(c[b] = $("input[name='" + b + "']:checked").val()), d.push(c);
		}),
		getObjectFromObject(d, b)
	);
}
function getObjectFromObject(a, b) {
	return (
		$.each(a, function (a, c) {
			$.each(c, function (d) {
				d && (b[a] = c);
			});
		}),
		console.log(b),
		b
	);
}
function preloadService(a) {
	$.each(a, function (b) {
		document.getElementById(b) &&
			("boolean" == typeof a[b].isSelected
				? $("#" + b).prop("checked", !0)
				: (document.getElementById(b).value = a[b].quantity));
	});
}
function goToPage(a) {
	window.location.href = a;
}
function getSession(a, b) {
	return b && sessionStorage[a]
		? JSON.parse(sessionStorage[a])
		: sessionStorage[a]
		? sessionStorage[a]
		: void 0;
}
function newStorage(a, b) {
	sessionStorage.getItem(a) == null && sessionStorage.setItem(a, b);
}
function saveSession(a, b) {
	let c;
	(c = "object" == typeof b ? JSON.stringify(b) : b),
		sessionStorage.getItem(a) == null
			? newStorage(a, c)
			: (sessionStorage.removeItem(a), sessionStorage.setItem(a, c));
}
function wipeStorage() {
	sessionStorage.clear();
}
function getDateFormat(a, b, c, d) {
	a.setUTCDate(a.getUTCDate());
	let e = a.getUTCHours() + 4,
		f = a.getUTCDate() + b,
		g = a.getUTCMonth() + 1 + c,
		h = a.getFullYear() + d;
	return (
		10 > f && (f = "0" + f),
		10 > g && (g = "0" + g),
		(a = h + "-" + g + "-" + f),
		a
	);
}
function dateDiff(a, b) {
	let c = (b - a) / 1e3;
	return (
		(c = Math.abs(Math.floor(c))),
		(dateDiffHolder = Math.floor(c / 86400)),
		a > b && (dateDiffHolder = 0),
		dateDiffHolder + 1
	);
}
function getIDFromUrl() {
	let a = new URL(window.location.href);
	return a.searchParams.get("batchID");
}
function loadinfoByClass(a, b) {
	let c = document.getElementsByClassName(a);
	Array.from(c).forEach((a) => {
		a.innerHTML = b;
	});
}
function newGenForms() {
	var a = document.getElementsByClassName("needs-validation");
	Array.prototype.filter.call(a, function (a) {
		a.addEventListener(
			"submit",
			function (b) {
				b.stopPropagation(),
					b.preventDefault(),
					!1 === a.checkValidity()
						? console.log("Form not valid")
						: console.log("Form is valid"),
					a.classList.add("was-validated");
			},
			!1
		);
	});
}
function styleSearch(a, b) {
	let c = "";
	return (
		$.each(a, (a, d) => {
			c += `<div class="d-block m-1 bg-lighter rounded"><a class="d-block text-white p-1 bg-lighter rounded" href="batch?batchID=${
				d.id
			}"><strong class="text-black">${d.trainingTrack.substr(
				0,
				b.length
			)}</strong>${d.trainingTrack.substr(b.length)}<small> - <i>[${
				d.name
			}]</i> Started(${d.startDate}) and goes for ${
				d.totalWeeks
			} weeks</small></a></div>`;
		}),
		c
	);
}
document.addEventListener("click", function (a) {
	closeAllLists(a.target);
});
function closeAllLists(a) {
	a == document.getElementById("searchSuggestion") ||
		a == document.getElementById("search") ||
		document.getElementById("searchSuggestion").classList.contains("d-none") ||
		document.getElementById("searchSuggestion").classList.add("d-none");
}
$("input[type=search]").on("search", function () {
	document.getElementById("searchSuggestion").classList.contains("d-none") ||
		document.getElementById("searchSuggestion").classList.add("d-none");
});
